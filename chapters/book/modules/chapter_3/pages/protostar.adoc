[id="protostar"]

= Protostar

https://docs.swmansion.com/protostar/[Protostar] æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ Starknet å¼€å‘å¹³å°ã€‚ è¯¥å·¥å…·ç®€åŒ–äº†ç®¡ç†ä¾èµ–ã€ç¼–è¯‘é¡¹ç›®ã€è¿è¡Œæµ‹è¯•ä»¥åŠä¸ Starknet é“¾äº¤äº’çš„è¿‡ç¨‹ã€‚ Protostar å…è®¸å¼€å‘äººå‘˜ä»¥ç®€åŒ–çš„æ–¹å¼ç¼–å†™ã€æµ‹è¯•å’Œéƒ¨ç½²ä»–ä»¬çš„ Cairo åˆçº¦ã€‚

== å®‰è£…

é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå®‰è£… Protostarã€‚è¯¥è¿›ç¨‹ç›®å‰æ”¯æŒ Linux å’Œ MacOS ç³»ç»Ÿï¼ˆWindows æ”¯æŒæ­£åœ¨è¿›è¡Œä¸­ï¼‰ã€‚

é€šè¿‡æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®‰è£…ï¼š

[source,bash]
----
curl -L https://raw.githubusercontent.com/software-mansion/protostar/master/install.sh | bash
----

å®‰è£…å®Œæˆåï¼Œé‡æ–°å¯åŠ¨ç»ˆç«¯ã€‚ æ£€æŸ¥æ‚¨å®‰è£…çš„ Protostar çš„ç‰ˆæœ¬æ˜¯å¦ä¸º https://github.com/software-mansion/protostar/releases[most recent version]ã€‚å¦‚æœä¸æ˜¯ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ–°æ‚¨çš„ Protostar ç‰ˆæœ¬ï¼š

[source,bash]
----
# Check your current version
protostar -v

# Update to the latest version
protostar upgrade
----

== æ”¯æŒçš„è½¯ä»¶ç‰ˆæœ¬

ç¡®ä¿æ‚¨å°† Protostar å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚ Protostar ç›®å‰ä¸æ”¯æŒ Windowsã€‚

== éªŒè¯å®‰è£…

å®‰è£… Protostar åï¼Œé€šè¿‡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ç‰ˆæœ¬æ¥éªŒè¯å®ƒï¼š

[source,bash]
----
protostar -v
----

è¾“å‡ºåº”å¦‚ä¸‹æ‰€ç¤ºï¼š

[source,bash]
----
Protostar version: 0.12.0                                                                                                       
Cairo-lang version: 0.11.1.1
Cairo 1 compiler version: 1.0.0rc0
21:03:44 [INFO] Execution time: 1.34 s
----

æ³¨æ„ Cairo-lang æ˜¯ Starknet ç½‘ç»œçš„ç‰ˆæœ¬ï¼ŒCairo 1 compiler æ˜¯ Cairo ç¼–è¯‘å™¨çš„ç‰ˆæœ¬ã€‚

== å¯åŠ¨æ–°Cairoé¡¹ç›®

æˆåŠŸå®‰è£…å’ŒéªŒè¯ Protostar åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ªæ–°é¡¹ç›®ï¼š

[source,bash]
----
protostar init my_project
cd my_project
----

æ‚¨çš„é¡¹ç›®ç›®å½•çš„ç»“æ„åº”ç±»ä¼¼äºï¼š

[source,bash]
----
my_project/
â”œâ”€â”€ hello_starknet/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ business_logic/
â”‚   â”‚   â”‚   â””â”€â”€ utils.cairo
â”‚   â”‚   â”œâ”€â”€ contracts/
â”‚   â”‚   â”‚   â””â”€â”€ hello_starknet.cairo
â”‚   â”‚   â”œâ”€â”€ business_logic.cairo
â”‚   â”‚   â”œâ”€â”€ contracts.cairo
â”‚   â”‚   â””â”€â”€ lib.cairo
â”‚   â””â”€â”€ cairo_project.toml
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_hello_starknet.cairo
â”‚   â””â”€â”€ test_utils.cairo
â””â”€â”€ protostar.toml
----

éœ€è¦æ³¨æ„çš„é‡ç‚¹æ˜¯æˆ‘ä»¬å¦‚ä½•å°†è¿™ä¸¤ä¸ªåˆçº¦æ„å»ºä¸ºç‹¬ç«‹çš„åº“ã€‚ Protostar ä¸­çš„æ¯ä¸ªæ™ºèƒ½åˆçº¦éƒ½å¿…é¡»æ„å»ºä¸ºè‡ªå·±çš„åº“ï¼Œæ¯ä¸ªåˆçº¦éƒ½æ˜¯ç”¨  `[contract]`  è£…é¥°å™¨è£…é¥°çš„è‡ªå·±çš„æ¨¡å—ã€‚

æµè§ˆå®˜æ–¹ Protostar æ–‡æ¡£ï¼Œäº†è§£æœ‰å…³æ„å»ºé¡¹ç›®çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼š https://docs.swmansion.com/protostar/docs/cairo-1/introduction


== æµ‹è¯•åˆçº¦

åœ¨ Cairo æ™ºèƒ½åˆçº¦é¢†åŸŸï¼Œæœ‰ä¸¤ç§ä¸»è¦çš„æ–¹æ³•æ¥æµ‹è¯•ä½ çš„åˆçº¦ï¼šåœ¨ Cairo å†…éƒ¨ï¼Œæˆ–è€…ä½¿ç”¨ Pythonã€Javascript æˆ– Rustã€‚

Cairo å†…éƒ¨æµ‹è¯•é€šå¸¸æ˜¯é¦–é€‰ï¼Œå› ä¸ºå®ƒå¯ä»¥é¿å…å¼€å‘äººå‘˜æ¯æ¬¡éœ€è¦æµ‹è¯•æ—¶éƒ½å¿…é¡»è¿›è¡Œåˆçº¦éƒ¨ç½²ï¼Œå¹¶ä¸”æ¶ˆé™¤äº†ä¸ºæµ‹è¯•è€Œå­¦ä¹ æ–°è¯­è¨€çš„å¿…è¦æ€§ã€‚

ä½¿ç”¨å‘½ä»¤æ‰§è¡Œæµ‹è¯•ï¼š

[source,bash]
----
protostar test
----

æˆåŠŸçš„æµ‹è¯•æ‰§è¡Œå°†æä¾›ç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„è¾“å‡ºï¼š

[source,bash]
----
Collected 2 suites, and 3 test cases (11.32)                                                                                                                    
[PASS] tests/test_utils.cairo test_returns_two (time=0.00s)                                                                                                     
[PASS] tests/test_hello_starknet.cairo test_increase_balance (time=25.81s)                                                                                      
[PASS] tests/test_hello_starknet.cairo test_cannot_increase_balance_with_zero_value (time=25.19s)                                                               
Test suites: 2 passed, 2 total                                                                                                                                  
Tests:       3 passed, 3 total
Seed:        720541691
21:17:52 [INFO] Execution time: 66.70 s
----


== é¡¹ç›®ç¼–è¯‘

åœ¨ç½‘ç»œä¸Šéƒ¨ç½²é¡¹ç›®ä¹‹å‰ï¼Œå¿…é¡»å°†å…¶ç¼–è¯‘æˆ Starknet ç½‘ç»œå¯ä»¥ç†è§£å’Œæ‰§è¡Œçš„å½¢å¼ã€‚ Protostar çš„ build å‘½ä»¤å¯ä»¥ä½¿æ­¤è¿‡ç¨‹å˜å¾—ç®€å•ã€‚

ä½¿ç”¨buildå‘½ä»¤ç¼–è¯‘æ‚¨çš„Cairo1é¡¹ç›®ï¼š

[source,bash]
----
protostar build
----

å¦‚æœç¼–è¯‘æˆåŠŸï¼Œè¾“å‡ºå°†ç±»ä¼¼äºï¼š

[source,bash]
----
21:00:22 [INFO] Building cairo1 contracts                                                                                                                       
21:00:27 [INFO] Contracts built successfully
21:00:27 [INFO] Execution time: 6.22 s
----

== åˆçº¦å£°æ˜

æˆåŠŸç¼–è¯‘æ‚¨çš„é¡¹ç›®åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å£°æ˜æ‚¨çš„åˆåŒã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šé€šçŸ¥ç½‘ç»œä½ æ‰“ç®—éƒ¨ç½²ä¸€ä¸ªæ–°åˆçº¦ï¼ˆæŸ¥çœ‹ç¬¬ 2 ç« ä»¥äº†è§£æ›´å¤šå…³äºåˆçº¦å£°æ˜è¿‡ç¨‹çš„ç»†èŠ‚ï¼‰ã€‚

åœ¨å£°æ˜åˆçº¦ä¹‹å‰ï¼Œå¿…é¡»å…ˆä¸ºæ‚¨çš„ç§é’¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

[source,bash]
----
export PROTOSTAR_ACCOUNT_PRIVATE_KEY=0x...
----

ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å£°æ˜æ‚¨çš„åˆçº¦ï¼š

[source,bash]
----
protostar declare hello_starknet \
  --network testnet \
  --account-address YOUR_ACCOUNT_ADDRESS \
  --max-fee auto
----

æ³¨æ„ï¼šå°†  `YOUR_ACCOUNT_ADDRESS`  æ›¿æ¢ä¸ºæ‚¨çš„å®é™…å¸æˆ·åœ°å€ã€‚

æˆåŠŸçš„å£°æ˜å°†ç”Ÿæˆç±»å“ˆå¸Œå’Œç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„è¾“å‡ºï¼š

[source,bash]
----
Declare transaction was sent.                                                                                                                                   
Class hash: 0x04ad47b818e8811a8c1df2a03a26381da0232bb7da3cba274831c2cfc9953acd
StarkScan https://testnet.starkscan.co/class/0x04ad47b818e8811a8c1df2a03a26381da0232bb7da3cba274831c2cfc9953acd
Voyager   https://goerli.voyager.online/class/0x04ad47b818e8811a8c1df2a03a26381da0232bb7da3cba274831c2cfc9953acd
Transaction hash: 0x03d048f8dc599c7d9bad1e5a7a039c35463b9479f0966766bc0df03cd89d6d7d
StarkScan https://testnet.starkscan.co/tx/0x03d048f8dc599c7d9bad1e5a7a039c35463b9479f0966766bc0df03cd89d6d7d
Voyager   https://goerli.voyager.online/tx/0x03d048f8dc599c7d9bad1e5a7a039c35463b9479f0966766bc0df03cd89d6d7d
21:01:23 [INFO] Execution time: 27.95 s
----

== åˆçº¦éƒ¨ç½²

å£°æ˜åˆçº¦åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å°†å…¶éƒ¨ç½²åˆ°ç½‘ç»œä¸Šã€‚åˆçº¦éƒ¨ç½²å¯ä»¥è®©æ‚¨çš„åˆåŒåœ¨ Starknet ä¸Šç”Ÿæ•ˆå¹¶å¯äº¤äº’ã€‚

è¦éƒ¨ç½²æ‚¨çš„åˆçº¦ï¼Œè¯·ä½¿ç”¨ä»å£°æ˜æ­¥éª¤ç”Ÿæˆçš„ç±»å“ˆå¸Œå’Œ  `protostar deploy`  å‘½ä»¤ï¼š

[source,bash]
----
protostar deploy \
  0x04ad47b818e8811a8c1df2a03a26381da0232bb7da3cba274831c2cfc9953acd \
  --network testnet \
  --account-address YOUR_ACCOUNT_ADDRESS \
  --max-fee auto
----

æ³¨æ„ï¼šå°†  `YOUR_ACCOUNT_ADDRESS`  æ›¿æ¢ä¸ºæ‚¨çš„å®é™…å¸æˆ·åœ°å€ã€‚

deploy å‘½ä»¤åçš„ â€œ0xâ€ åœ°å€æ˜¯åˆçº¦å£°æ˜æœŸé—´ç”Ÿæˆçš„ç±»å“ˆå¸Œã€‚

æˆåŠŸéƒ¨ç½²å°†æä¾›ä¸€ä¸ªåˆçº¦åœ°å€å’Œç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š

[source,bash]
----
Invoke transaction was sent to the Universal Deployer Contract.                                                                                                 
Contract address: 0x02341c459847cf220671ab873e14d853197c74e239c3b5815b0aa2e85bc37ebd
StarkScan https://testnet.starkscan.co/contract/0x02341c459847cf220671ab873e14d853197c74e239c3b5815b0aa2e85bc37ebd
Voyager   https://goerli.voyager.online/contract/0x02341c459847cf220671ab873e14d853197c74e239c3b5815b0aa2e85bc37ebd
Transaction hash: 0x03406b79b189d8752cff632ea8e0df332d7be7e27ffbc453fbf210c7384c0676
StarkScan https://testnet.starkscan.co/tx/0x03406b79b189d8752cff632ea8e0df332d7be7e27ffbc453fbf210c7384c0676
Voyager   https://goerli.voyager.online/tx/0x03406b79b189d8752cff632ea8e0df332d7be7e27ffbc453fbf210c7384c0676
21:25:26 [INFO] Execution time: 3.22 s
----

== ä¸€ä¸ªç®€å•çš„æ¼”ç¤º

è¦äº†è§£å¦‚ä½•å¼€å§‹ä½¿ç”¨ Protostarï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„é¡¹ç›®ã€‚é¦–å…ˆï¼Œå¯¼èˆªåˆ°æ‚¨çš„ç»ˆç«¯å¹¶æ‰§è¡Œï¼š

[source,bash]
----
git clone https://github.com/SupremeSingh/protostar-cairo1-template.git
cd protostar-cairo1-template
----

ç°åœ¨ï¼Œæ‚¨å¯ä»¥è®¿é—®ä¸€ä¸ªåŸºæœ¬çš„ Protostar é¡¹ç›®ï¼Œè¯¥é¡¹ç›®åœ¨  `Cairo 1.0`  ä¸­å®ç°äº†ä¸¤ä¸ªæ™ºèƒ½åˆçº¦ä»¥åŠå…¶ä»–ä¸šåŠ¡é€»è¾‘ã€‚ åœ¨ç»§ç»­ä¹‹å‰ï¼Œå»ºè®®æ‚¨ç†Ÿæ‚‰  `erc20.cairo`  å’Œ  `hello_starknet.cairo`  ä¸­çš„ä»£ç ã€‚

ä¸ºäº†æ›´æ·±å…¥åœ°äº†è§£æµ‹è¯•ï¼Œå¼ºçƒˆå»ºè®®æ£€æŸ¥  `tests/test_erc20.cairo`  ä¸­çš„æµ‹è¯•ï¼Œå¹¶å°†å®ƒä»¬ä¸  `contracts/erc20.cairo`  ä¸­çš„åŸå§‹åˆçº¦è¿›è¡Œæ¯”è¾ƒã€‚

== è°ƒè¯•

å¯¹äºä»£ç è°ƒè¯•ï¼Œèƒ½å¤Ÿæ‰“å°å‡ºå€¼æˆ–éš”ç¦»åŒ¹é…è¯­å¥ä¸­çš„é”™è¯¯æ˜¯æœ‰ç›Šçš„ã€‚Protostar å·²ç»æä¾›äº†è¿™äº›åŠŸèƒ½ã€‚

è¦æ‰“å°å‡ºå€¼ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

[source,bash]
----
use array::ArrayTrait;
use array::ArrayTCloneImpl;
use array::SpanTrait;
use debug::PrintTrait;
use clone::Clone;

array.span().snapshot.clone().print(); // Print an array value
felt.print() // Print an individual value
----

æ‚¨è¿˜å¯ä»¥åƒè¿™æ ·ä½¿ç”¨åŒ¹é…è¯­å¥ï¼š

[source,bash]
----
match invoke(deployed_contract_address, 'panic_with', @panic_data) {
    Result::Ok(x) => assert(false, 'Shouldnt have succeeded'),
    Result::Err(x) => {
        assert(x.first() == 'error', 'first datum doesnt match');
        assert(*x.panic_data.at(1_u32) == 'data', 'second datum doesntmatch');
    }
}
----

æœ€åï¼Œä¸ºäº†è®©æ‚¨çš„ä»£ç ä¸ Starknet äº¤äº’ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Protostar æä¾›çš„å®Œæ•´å‘½ä»¤åˆ—è¡¨ã€‚æ‚¨å¯ä»¥åœ¨ (https://docs.swmansion.com/protostar/docs/cairo-1/interacting-with-starknet) æ‰¾åˆ°è¿™äº›å‘½ä»¤ã€‚

== å¸¸è§çš„é™·é˜±

- æ¯ä¸ªæµ‹è¯•éƒ½åº”å‘½åä¸º  `test_<further name>.cairo`  ä»¥ä¾¿æ¡†æ¶å¯ä»¥è¯†åˆ«å®ƒã€‚
- æµ‹è¯•éœ€è¦ç”¨  `#[test]`  ä¿®é¥°ï¼Œæ²¡æœ‰å‚æ•°ï¼Œå¹¶åŒ…å«ä¸€ä¸ªæ–­è¨€ã€‚
-   `contract_address_const::<0>()`  æ˜¯æ‰€æœ‰è°ƒç”¨çš„é»˜è®¤è°ƒç”¨è€…ã€‚
- éœ€è¦ä½¿ç”¨prankæ¥æ›´æ”¹è°ƒç”¨è€…åœ°å€ã€‚
- è°ƒç”¨æ—¶éœ€è¦å°†  `u256`  å€¼æ‹†åˆ†ä¸ºä¸¤ä¸ª  `felt252`  å€¼ã€‚
- Protostar ç›®å‰ä¸æ”¯æŒå‘å‡ºæµ‹è¯•äº‹ä»¶çš„  `#[external]`  å‡½æ•°ã€‚è¯·ç­‰å¾…ä¸‹ä¸€ä¸ªç‰ˆæœ¬ã€‚

== ç»“è®º

Protostar ä»£è¡¨äº†ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·é›†ï¼Œç”¨äºåœ¨ Starknet ç½‘ç»œä¸Šå¼€å‘ã€æµ‹è¯•å’Œéƒ¨ç½²æ™ºèƒ½åˆçº¦ã€‚ æœ¬æŒ‡å—å‘æ‚¨ä»‹ç»äº†å®ƒçš„ä¸»è¦åŠŸèƒ½ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•åœ¨ä¸€ä¸ªç®€å•é¡¹ç›®çš„ç¯å¢ƒä¸­ä½¿ç”¨å®ƒã€‚å°½ç®¡éœ€è¦æ³¨æ„ä¸€äº›ç»†å¾®å·®åˆ«å’Œâ€œé™·é˜±â€ï¼Œä½†ä½¿ç”¨ Protostar çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚éšç€ Starknet ç”Ÿæ€ç³»ç»Ÿçš„å‘å±•ï¼Œåƒ Protostar è¿™æ ·çš„å·¥å…·å°†ç»§ç»­åœ¨å¸®åŠ©å¼€å‘äººå‘˜æ„å»ºå¼ºå£®ã€å¯é å’Œå®‰å…¨çš„å»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åºæ–¹é¢å‘æŒ¥å…³é”®ä½œç”¨ã€‚ç¼–ç æ„‰å¿«ï¼


ğŸ’¡ é™„æ³¨

ã€ŠStarknet ä¹‹ä¹¦ã€‹æ˜¯ Starknet ç¤¾åŒºæˆå‘˜åˆåŠ›ä¹‹ä½œï¼Œä¾¿äºç¤¾åŒºæˆå‘˜å­¦ä¹ ä¹‹ç”¨ã€‚

- æ— è®ºä½ æ˜¯å¦æœ‰æ‰€æ”¶è·ï¼Œçƒ¦è¯· https://a.sprig.com/WTRtdlh2VUlja09lfnNpZDo4MTQyYTlmMy03NzdkLTQ0NDEtOTBiZC01ZjAyNDU0ZDgxMzU=[å¡«å†™æ­¤é—®å·]ï¼Œç®€å•å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼Œç»™äºˆæˆ‘ä»¬åé¦ˆã€‚
- è‹¥å‘ç°ä»»ä½•é”™è¯¯ï¼Œæˆ–æœ‰å…¶ä»–å»ºè®®ï¼Œè¯·åœ¨æˆ‘ä»¬çš„ https://github.com/starknet-edu/starknetbook/issues[Github ä»“åº“å‘èµ·é—®é¢˜å• (Issues)]ã€‚




== **è´¡çŒ®åŠ›é‡**

> é‡Šæ”¾ä½ çš„çƒ­æƒ…ï¼Œè®©ã€ŠStarknet ä¹‹ä¹¦ã€‹æ›´åŠ å®Œç¾
> 
> 
> *ã€ŠStarknet ä¹‹ä¹¦ã€‹ä¾ç„¶åœ¨ä¸æ–­å®Œå–„ä¸­ï¼Œè€Œä½ çš„çƒ­æƒ…ã€ä¸“ä¸šçŸ¥è¯†å’Œç‹¬åˆ°è§è§£å¯ä»¥å°†å®ƒå¡‘é€ æˆä¸€éƒ¨çœŸæ­£å“è¶Šçš„ä½œå“ã€‚ä¸è¦å®³æ€•æŒ‘æˆ˜ç°çŠ¶æˆ–æ˜¯é¢ è¦†è¿™æœ¬ä¹¦ï¼é½å¿ƒååŠ›ï¼Œæˆ‘ä»¬ä¸€èµ·åˆ›é€ è¿™ä»½å®è´µçš„èµ„æºï¼Œé€ ç¦æ— æ•°äººã€‚*
> 
> *ä¸ºå…¬å…±äº‹ä¸šè´¡çŒ®åŠ›é‡ã€‚å¦‚æœä½ å‘ç°æœ¬ä¹¦æœ‰æ”¹è¿›çš„ç©ºé—´ï¼Œé‚£å°±æŠ“ä½æœºä¼šå§ï¼æŸ¥çœ‹æˆ‘ä»¬çš„[æŒ‡å—](https://github.com/starknet-edu/starknetbook/blob/main/CONTRIBUTING.adoc) å¹¶åŠ å…¥æ´»åŠ›æ»¡æ»¡çš„ç¤¾åŒºã€‚ä¸€èµ·æ— ç•å…±å»º Starknetï¼*
> 

â€” Starknet ç¤¾åŒº

[id="starknetjs"]

= Starknet.js - Starknet JavaScript SDK

Starknet.js æ˜¯ä¸€ä¸ª JavaScript/TypeScript åº“ï¼Œæ—¨åœ¨å°†æ‚¨çš„ç½‘ç«™æˆ–å»ä¸­å¿ƒåŒ–åº”ç”¨ç¨‹åº (D-App) è¿æ¥åˆ° Starknetã€‚å®ƒæ—¨åœ¨æ¨¡ä»¿ https://docs.ethers.org/v5/[ethers.js] çš„æ¶æ„ï¼Œå› æ­¤å¦‚æœæ‚¨ç†Ÿæ‚‰ ethers.jsï¼Œæ‚¨åº”è¯¥ä¼šå‘ç° Starknet.js æ˜“äºä½¿ç”¨ã€‚

image::starknet-js.png[starknet-js]

== å®‰è£…

è¦å®‰è£… Starknet.jsï¼Œè¯·æŒ‰ç…§ä¸‹åˆ—æ­¥éª¤æ“ä½œï¼š

* å¯¹äºæœ€æ–°çš„å®˜æ–¹ç‰ˆæœ¬ï¼ˆä¸»åˆ†æ”¯ï¼‰ï¼š

[source, bash]
----
npm install starknet
----

* è¦ä½¿ç”¨æœ€æ–°åŠŸèƒ½ï¼ˆåˆå¹¶åˆ° develop åˆ†æ”¯ä¸­ï¼‰ï¼š

[source, bash]
----
npm install starknet@next
----

== å¼€å§‹

è¦æ„å»ºç”¨æˆ·èƒ½å¤Ÿè¿æ¥åˆ° Starknet å¹¶ä¸ä¹‹äº¤äº’çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å»ºè®®æ·»åŠ  https://github.com/starknet-io/get-starknet[get-starknet] åº“ï¼Œå®ƒå…è®¸æ‚¨ç®¡ç†é’±åŒ…è¿æ¥ã€‚

å‡†å¤‡å¥½è¿™äº›å·¥å…·åï¼Œå‰ç«¯åŸºæœ¬ä¸Šéœ€è¦äº†è§£ 3 ä¸ªä¸»è¦æ¦‚å¿µï¼šå¸æˆ·ã€æä¾›å•†å’Œåˆçº¦ã€‚

### è´¦æˆ·
æˆ‘ä»¬é€šå¸¸å¯ä»¥å°†å¸æˆ·è§†ä¸º dapp çš„ â€œæœ€ç»ˆç”¨æˆ·â€ï¼Œå¹¶ä¸”ä¼šæ¶‰åŠä¸€äº›ç”¨æˆ·äº¤äº’ä»¥è·å–å¯¹å®ƒçš„è®¿é—®æƒé™ã€‚

æƒ³ä¸€æƒ³ç”¨æˆ·è¿æ¥ä»–ä»¬çš„æµè§ˆå™¨æ‰©å±•é’±åŒ…ï¼ˆä¾‹å¦‚ ArgentX æˆ– Braavosï¼‰çš„ dapp â€”â€”å¦‚æœç”¨æˆ·æ¥å—è¿æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¸æˆ·å’Œç­¾åè€…ï¼Œåè€…å¯ä»¥ç­¾ç½²äº¤æ˜“å’Œæ¶ˆæ¯ã€‚

ä¸ä»¥å¤ªåŠä¸åŒï¼Œç”¨æˆ·è´¦æˆ·æ˜¯å¤–éƒ¨æ‹¥æœ‰çš„è´¦æˆ·ï¼ŒStarknet è´¦æˆ·æ˜¯åˆçº¦ã€‚è¿™ä¸ä¸€å®šä¼šå½±å“ä½ çš„ dapp çš„å‰ç«¯ï¼Œä½†ä½ ç»å¯¹åº”è¯¥æ„è¯†åˆ°è¿™ç§å·®å¼‚ã€‚

```ts
async function connectWallet() {
    const starknet = await connect();
    console.log(starknet.account);
    
    const nonce = await starknet.account.getNonce();
    const message = await starknet.account.signMessage(...)
}
```
ä¸Šé¢çš„ä»£ç ç‰‡æ®µä½¿ç”¨äº† `get-starknet` æä¾›çš„è¿æ¥åŠŸèƒ½æ¥å»ºç«‹ä¸ç”¨æˆ·é’±åŒ…çš„è¿æ¥ã€‚è¿æ¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®å¸æˆ·æ–¹æ³•ï¼Œä¾‹å¦‚ `signMessage` æˆ– `execute` ã€‚

### æä¾›å•†
è¯¥æä¾›å•†å…è®¸æ‚¨ä¸ Starknet ç½‘ç»œè¿›è¡Œäº¤äº’ã€‚æ‚¨å¯ä»¥å°†å…¶è§†ä¸ºä¸åŒºå—é“¾çš„â€œè¯»å–â€è¿æ¥ï¼Œå› ä¸ºå®ƒä¸å…è®¸ç­¾ç½²äº¤æ˜“æˆ–æ¶ˆæ¯ã€‚å°±åƒåœ¨ä»¥å¤ªåŠä¸­ä¸€æ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤æä¾›ç¨‹åºï¼Œæˆ–ä½¿ç”¨ Infura æˆ– Alchemy ç­‰æœåŠ¡ï¼ˆå®ƒä»¬éƒ½æ”¯æŒ Starknetï¼‰æ¥åˆ›å»º RPC æä¾›ç¨‹åºã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼Œæä¾›è€…æ˜¯æ’åºå™¨æä¾›è€…ã€‚

```ts
export const provider = new Provider({
  sequencer: {
    network: "goerli-alpha",
  },
  // rpc: {
  //   nodeUrl: INFURA_ENDPOINT
  // }
});

const block = await provider.getBlock("latest"); // <- Get latest block    
console.log(block.block_number);
```

### åˆçº¦
æ‚¨çš„å‰ç«¯å¯èƒ½ä¼šä¸å·²éƒ¨ç½²çš„åˆçº¦è¿›è¡Œäº¤äº’ã€‚å¯¹äºæ¯ä¸ªåˆçº¦ï¼Œå‰ç«¯éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå¯¹åº”çš„å‰¯æœ¬ã€‚è¦åˆ›å»ºè¿™äº›å®ä¾‹ï¼Œæ‚¨éœ€è¦åˆçº¦çš„åœ°å€å’Œ ABIï¼Œä»¥åŠæä¾›è€…æˆ–ç­¾åè€…ã€‚

```ts
const contract = new Contract(
  abi_erc20,
  contractAddress,
  starknet.account
);

const balance = await contract.balanceOf(starknet.account.address);
const transfer = await contract.transfer(recipientAddress, amountFormatted);
//or: const transfer = await contract.invoke("transfer", [to, amountFormatted]); 

console.log(`Tx hash: ${transfer.transaction_hash}`);
```

å¦‚æœæ‚¨ä½¿ç”¨æä¾›è€…åˆ›å»ºåˆåŒå®ä¾‹ï¼Œæ‚¨å°†ä»…é™äºè°ƒç”¨åˆåŒä¸Šçš„è¯»å–å‡½æ•°â€”â€”åªæœ‰ä½¿ç”¨ç­¾åè€…æ‰èƒ½æ›´æ”¹åŒºå—é“¾çš„çŠ¶æ€ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥å°†ä¹‹å‰åˆ›å»ºçš„  `Contract`  å®ä¾‹è¿æ¥åˆ°æ–°å¸æˆ·ï¼š

```ts
const contract = new Contract(
  abi_erc20,
  contractAddress,
  provider
);

contract.connect(starknet.account);
```
åœ¨ä¸Šé¢çš„ä»£ç ç‰‡æ®µä¸­ï¼Œåœ¨è°ƒç”¨ `connect` æ–¹æ³•ä¹‹åï¼Œå¯ä»¥è°ƒç”¨åˆçº¦ä¸Šçš„è¯»å–å‡½æ•°ï¼Œä½†è°ƒç”¨ connect ä¹‹å‰åˆ™ä¸èƒ½ã€‚

## å•ä½
å¦‚æœä½ ä»¥å‰æœ‰è¿‡ web3 çš„ç»éªŒï¼Œä½ å°±ä¼šçŸ¥é“å¤„ç†å•å…ƒéœ€è¦å°å¿ƒï¼ŒStarknet ä¹Ÿä¸ä¾‹å¤–ã€‚å†ç”³æ˜ï¼Œæ–‡æ¡£åœ¨è¿™é‡Œéå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯å…³äº https://www.starknetjs.com/docs/guides/define_call_message/[æ•°æ®è½¬æ¢] çš„è¿™ä¸€éƒ¨åˆ†ã€‚

å¾ˆå¤šæ—¶å€™ï¼Œæ‚¨éœ€è¦å°†ä»åˆçº¦è¿”å›çš„ Cairo ç»“æ„ï¼ˆä¾‹å¦‚ Uint256ï¼‰è½¬æ¢ä¸ºæ•°å­—ï¼š

```ts
// Uint256 shape:
// { 
//    type: 'struct', 
//    low: Uint256.low, 
//    high: Uint256.high 
// 
// }
const balance = await contract.balanceOf(address); // <- uint256
const asBN = uint256.uint256ToBN(uint256); // <- uint256 into BN
const asString = asBN.toString() //<- BN into string
```
åä¹‹äº¦ç„¶ï¼š

```ts
const amount = 1;

const amountFormatted = {
    type: "struct",
    ...uint256.bnToUint256(amount),
};
```

é™¤äº†  `bnToUint256`  å’Œ  `uint256ToBN`  ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–æœ‰ç”¨çš„å®ç”¨ç¨‹åºä¹Ÿæ˜¯ç”± Starknet.js æä¾›ã€‚

æˆ‘ä»¬ç°åœ¨æœ‰äº†æ„å»º Starknet dapp çš„åšå®åŸºç¡€ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¸“é—¨çš„æ¡†æ¶å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»º Starknet dappsï¼Œè¿™åœ¨ç¬¬ 5 ç« ä¸­æœ‰æ‰€ä»‹ç»ã€‚



== å…¶ä»–èµ„æº

- Starknet.js GitHub å­˜å‚¨åº“ï¼šhttps://github.com/0xs34n/starknet.js
- Starknet.js å®˜æ–¹ç½‘ç«™å’Œæ–‡æ¡£ï¼šhttps://www.starknetjs.com/

è¯·ç»§ç»­å…³æ³¨ Starknet.js çš„æ›´å¤šæ›´æ–°ï¼ŒåŒ…æ‹¬è¯¦ç»†çš„æŒ‡å—ã€ç¤ºä¾‹å’Œå…¨é¢çš„æ–‡æ¡£ã€‚



ğŸ’¡ é™„æ³¨

ã€ŠStarknet ä¹‹ä¹¦ã€‹æ˜¯ Starknet ç¤¾åŒºæˆå‘˜åˆåŠ›ä¹‹ä½œï¼Œä¾¿äºç¤¾åŒºæˆå‘˜å­¦ä¹ ä¹‹ç”¨ã€‚

- æ— è®ºä½ æ˜¯å¦æœ‰æ‰€æ”¶è·ï¼Œçƒ¦è¯· https://a.sprig.com/WTRtdlh2VUlja09lfnNpZDo4MTQyYTlmMy03NzdkLTQ0NDEtOTBiZC01ZjAyNDU0ZDgxMzU=[å¡«å†™æ­¤é—®å·]ï¼Œç®€å•å›ç­”ä¸‰ä¸ªé—®é¢˜ï¼Œç»™äºˆæˆ‘ä»¬åé¦ˆã€‚
- è‹¥å‘ç°ä»»ä½•é”™è¯¯ï¼Œæˆ–æœ‰å…¶ä»–å»ºè®®ï¼Œè¯·åœ¨æˆ‘ä»¬çš„ https://github.com/starknet-edu/starknetbook/issues[Github ä»“åº“å‘èµ·é—®é¢˜å• (Issues)]ã€‚


== **è´¡çŒ®åŠ›é‡**

> é‡Šæ”¾ä½ çš„çƒ­æƒ…ï¼Œè®©ã€ŠStarknet ä¹‹ä¹¦ã€‹æ›´åŠ å®Œç¾
> 
> 
> *ã€ŠStarknet ä¹‹ä¹¦ã€‹ä¾ç„¶åœ¨ä¸æ–­å®Œå–„ä¸­ï¼Œè€Œä½ çš„çƒ­æƒ…ã€ä¸“ä¸šçŸ¥è¯†å’Œç‹¬åˆ°è§è§£å¯ä»¥å°†å®ƒå¡‘é€ æˆä¸€éƒ¨çœŸæ­£å“è¶Šçš„ä½œå“ã€‚ä¸è¦å®³æ€•æŒ‘æˆ˜ç°çŠ¶æˆ–æ˜¯é¢ è¦†è¿™æœ¬ä¹¦ï¼é½å¿ƒååŠ›ï¼Œæˆ‘ä»¬ä¸€èµ·åˆ›é€ è¿™ä»½å®è´µçš„èµ„æºï¼Œé€ ç¦æ— æ•°äººã€‚*
> 
> *ä¸ºå…¬å…±äº‹ä¸šè´¡çŒ®åŠ›é‡ã€‚å¦‚æœä½ å‘ç°æœ¬ä¹¦æœ‰æ”¹è¿›çš„ç©ºé—´ï¼Œé‚£å°±æŠ“ä½æœºä¼šå§ï¼æŸ¥çœ‹æˆ‘ä»¬çš„[æŒ‡å—]https://github.com/starknet-edu/starknetbook/blob/main/CONTRIBUTING.adoc å¹¶åŠ å…¥æ´»åŠ›æ»¡æ»¡çš„ç¤¾åŒºã€‚ä¸€èµ·æ— ç•å…±å»º Starknetï¼*
> 

â€” Starknet ç¤¾åŒº
